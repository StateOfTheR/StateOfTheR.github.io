<!DOCTYPE html><html lang="fr-fr" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 4.8.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="L’atelier du jour avait pour objectif la découvert du package data.table au travers d’exercises proposés lors de la dernière édition de UseR. Les slides avec les énoncés sont disponibles ici.">

  
  <link rel="alternate" hreflang="fr-fr" href="http://stateofther.github.io/post/data.table/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#a6bddb">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="http://stateofther.github.io/post/data.table/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@RUG_stateofther">
  <meta property="twitter:creator" content="@RUG_stateofther">
  
  <meta property="og:site_name" content="State of The R">
  <meta property="og:url" content="http://stateofther.github.io/post/data.table/">
  <meta property="og:title" content="Exercices autour de data.table | State of The R">
  <meta property="og:description" content="L’atelier du jour avait pour objectif la découvert du package data.table au travers d’exercises proposés lors de la dernière édition de UseR. Les slides avec les énoncés sont disponibles ici."><meta property="og:image" content="http://stateofther.github.io/images/logo_hu53047fbf4f6efa69f0f91be25bd21dde_40228_300x300_fit_lanczos_2.png">
  <meta property="twitter:image" content="http://stateofther.github.io/images/logo_hu53047fbf4f6efa69f0f91be25bd21dde_40228_300x300_fit_lanczos_2.png"><meta property="og:locale" content="fr-fr">
  
    
      <meta property="article:published_time" content="2017-10-23T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2017-10-23T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://stateofther.github.io/post/data.table/"
  },
  "headline": "Exercices autour de data.table",
  
  "datePublished": "2017-10-23T00:00:00Z",
  "dateModified": "2017-10-23T00:00:00Z",
  
  "publisher": {
    "@type": "Organization",
    "name": "State of the R",
    "logo": {
      "@type": "ImageObject",
      "url": "http://stateofther.github.io/images/logo_hu53047fbf4f6efa69f0f91be25bd21dde_40228_192x192_fit_lanczos_2.png"
    }
  },
  "description": "L’atelier du jour avait pour objectif la découvert du package data.table au travers d’exercises proposés lors de la dernière édition de UseR. Les slides avec les énoncés sont disponibles ici."
}
</script>

  

  


  


  





  <title>Exercices autour de data.table | State of The R</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  











  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu53047fbf4f6efa69f0f91be25bd21dde_40228_0x70_resize_lanczos_2.png" alt="State of The R"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu53047fbf4f6efa69f0f91be25bd21dde_40228_0x70_resize_lanczos_2.png" alt="State of The R"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>Accueil</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#organisation"><span>Organisation</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Ateliers</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/#upcoming_workshops"><span>à venir</span></a>
            
              <a class="dropdown-item" href="/#past_workshops"><span>passés</span></a>
            
              <a class="dropdown-item" href="/#bootcamp"><span>bootcamp</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>À propos</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>



  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Exercices autour de data.table</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Oct 23, 2017
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    15 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/workshop/">workshop</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p>L’atelier du jour avait pour objectif la découvert du package <a href="https://cran.r-project.org/web/packages/data.table/index.html">data.table</a> au travers d’<a href="https://user2017.sched.com/event/Aw0L/datatable-for-beginners">exercises proposés lors de la dernière édition de UseR</a>. Les slides avec les énoncés sont <a href="https://www.google.fr/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiZv7DE6I3XAhWCuBoKHcN5CREQFggrMAA&amp;url=https%3A%2F%2Fchannel9.msdn.com%2FEvents%2FuseR-international-R-User-conferences%2FuseR-International-R-User-2017-Conference%2Fdatatable-for-beginners&amp;usg=AOvVaw3N-q_5oW0-yMm8uz9hVisu">disponibles ici</a>.</p>
<p>L’apport de notre atelier est d’avoir systématiquement essayé de traiter les questions avec
- les fonctionalités <code>R</code> de <em>base</em>
- les fonctionalités offertes par le <em>tidyverse</em> (principalement <em>dplyr</em>)
- les fonctionnalités du package <em>data.table</em></p>
<p>Pour les animateurs : vous êtes libre de compléter le post de blog. Nous ajouteroins des comparatifs en terme de temps de calcul plus tard (peut-être).</p>
<div id="préliminaires" class="section level3">
<h3>Préliminaires</h3>
<p>C’est parti, on charge les packages requis</p>
<pre class="r"><code>library(data.table)
library(tidyverse)</code></pre>
<p>Les exercices seront traités à l’aide de deux tables jouets, dont on propose des contreparties en
- object <code>data.frame</code>
- object <code>tibble</code>
- object <code>data.table</code></p>
<pre class="r"><code>set.seed(20170703L)
DF1 = data.frame(id = sample(1:2, 9L, TRUE), 
                 code = sample(letters[1:3], 9, TRUE), 
                 valA = 1:9, valB = 10:18, 
                 stringsAsFactors = FALSE)
DF2 = data.frame(id = c(3L, 1L, 1L, 2L, 3L), 
                 code = c(&quot;b&quot;, &quot;a&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;), 
                 mul = 5:1, stringsAsFactors = FALSE)
## corresponding data tibble
TB1 &lt;- as.tibble(DF1)</code></pre>
<pre><code>## Warning: `as.tibble()` is deprecated as of tibble 2.0.0.
## Please use `as_tibble()` instead.
## The signature and semantics have changed, see `?as_tibble`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre class="r"><code>TB2 &lt;- as.tibble(DF2)
## corresponding data tables
DT1 &lt;- as.data.table(DF1)
DT2 &lt;- as.data.table(DF2)</code></pre>
</div>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<p><em>Subset all rows where id column equals 1 &amp; code column is not equal to “c”</em></p>
<div id="base" class="section level4">
<h4>base</h4>
<pre class="r"><code>base::subset(DF1, id == 1 &amp; code != &quot;c&quot;)</code></pre>
<pre><code>##   id code valA valB
## 1  1    a    1   10
## 2  1    a    2   11
## 4  1    a    4   13</code></pre>
<pre class="r"><code>with(DF1, DF1[id == 1 &amp; code != &quot;c&quot;,])</code></pre>
<pre><code>##   id code valA valB
## 1  1    a    1   10
## 2  1    a    2   11
## 4  1    a    4   13</code></pre>
</div>
<div id="dplyr" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>filter(TB1, id == 1 &amp; code != &quot;c&quot;)</code></pre>
<pre><code>## # A tibble: 3 x 4
##      id code   valA  valB
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
## 1     1 a         1    10
## 2     1 a         2    11
## 3     1 a         4    13</code></pre>
</div>
<div id="data.table" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[id == 1 &amp; code != &quot;c&quot;] </code></pre>
<pre><code>##    id code valA valB
## 1:  1    a    1   10
## 2:  1    a    2   11
## 3:  1    a    4   13</code></pre>
</div>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p><em>Select valA and valB columns from DF1</em></p>
<div id="base-r" class="section level4">
<h4>base R</h4>
<pre class="r"><code>DF1[, c(&quot;valA&quot;, &quot;valB&quot;)]</code></pre>
<pre><code>##   valA valB
## 1    1   10
## 2    2   11
## 3    3   12
## 4    4   13
## 5    5   14
## 6    6   15
## 7    7   16
## 8    8   17
## 9    9   18</code></pre>
</div>
<div id="dplyr-1" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>select(TB1, valA, valB)</code></pre>
<pre><code>## # A tibble: 9 x 2
##    valA  valB
##   &lt;int&gt; &lt;int&gt;
## 1     1    10
## 2     2    11
## 3     3    12
## 4     4    13
## 5     5    14
## 6     6    15
## 7     7    16
## 8     8    17
## 9     9    18</code></pre>
</div>
<div id="data.table-1" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[ , .(valA,valB)]</code></pre>
<pre><code>##    valA valB
## 1:    1   10
## 2:    2   11
## 3:    3   12
## 4:    4   13
## 5:    5   14
## 6:    6   15
## 7:    7   16
## 8:    8   17
## 9:    9   18</code></pre>
</div>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<p><em>Get sum(valA) and sum(valB) for id &gt; 1 as a 1-row, 2-col data.frame</em></p>
<div id="base-r-1" class="section level4">
<h4>base R</h4>
<pre class="r"><code>colSums(DF1[ DF1$id &gt; 1, c(&quot;valA&quot;, &quot;valB&quot;)])</code></pre>
<pre><code>## valA valB 
##   30   66</code></pre>
</div>
<div id="dplyr-2" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 %&gt;% filter(id &gt; 1) %&gt;% select(valA, valB) %&gt;% summarise_all(sum)</code></pre>
<pre><code>## # A tibble: 1 x 2
##    valA  valB
##   &lt;int&gt; &lt;int&gt;
## 1    30    66</code></pre>
</div>
<div id="data.table-2" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[id &gt; 1, .(sum(valA), sum(valB))]</code></pre>
<pre><code>##    V1 V2
## 1: 30 66</code></pre>
</div>
</div>
<div id="question-4" class="section level3">
<h3>Question 4</h3>
<p><em>Replace valB with valB+1 for all rows where code == “c”</em></p>
<div id="base-r-2" class="section level4">
<h4>base R</h4>
<pre class="r"><code>DF1$valB[DF1$code==&quot;c&quot;] = DF1$valB[DF1$code==&quot;c&quot;] + 1
DF1</code></pre>
<pre><code>##   id code valA valB
## 1  1    a    1   10
## 2  1    a    2   11
## 3  1    c    3   13
## 4  1    a    4   13
## 5  1    c    5   15
## 6  2    a    6   15
## 7  2    a    7   16
## 8  2    c    8   18
## 9  2    b    9   18</code></pre>
</div>
<div id="dplyr-3" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 &lt;- TB1 %&gt;% mutate(valB = ifelse(code == &quot;c&quot;, valB + 1,valB))
## TB1[TB1$code==&quot;c&quot;, ] &lt;- filter(TB1, code==&quot;c&quot;) %&gt;% mutate(valB= valB+1) # alternative solution
TB1</code></pre>
<pre><code>## # A tibble: 9 x 4
##      id code   valA  valB
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;
## 1     1 a         1    10
## 2     1 a         2    11
## 3     1 c         3    13
## 4     1 a         4    13
## 5     1 c         5    15
## 6     2 a         6    15
## 7     2 a         7    16
## 8     2 c         8    18
## 9     2 b         9    18</code></pre>
</div>
<div id="data.table-3" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[code == &quot;c&quot;, valB := valB + 1L]
DT1</code></pre>
<pre><code>##    id code valA valB
## 1:  1    a    1   10
## 2:  1    a    2   11
## 3:  1    c    3   13
## 4:  1    a    4   13
## 5:  1    c    5   15
## 6:  2    a    6   15
## 7:  2    a    7   16
## 8:  2    c    8   18
## 9:  2    b    9   18</code></pre>
</div>
</div>
<div id="question-5" class="section level3">
<h3>Question 5</h3>
<p><em>Add a new column valC column with values equal to valB^2 - valA^2</em></p>
<div id="base-r-3" class="section level4">
<h4>base R</h4>
<pre class="r"><code>DF1 &lt;- transform(DF1, valC = valB^2 - valA^2)
## DF1$valC &lt;- DF1$valB^2 - DF1$valA^2 # alternate solution
DF1</code></pre>
<pre><code>##   id code valA valB valC
## 1  1    a    1   10   99
## 2  1    a    2   11  117
## 3  1    c    3   13  160
## 4  1    a    4   13  153
## 5  1    c    5   15  200
## 6  2    a    6   15  189
## 7  2    a    7   16  207
## 8  2    c    8   18  260
## 9  2    b    9   18  243</code></pre>
</div>
<div id="dplyr-4" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 &lt;- mutate(TB1, valC = valB^2 - valA^2)
TB1</code></pre>
<pre><code>## # A tibble: 9 x 5
##      id code   valA  valB  valC
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 a         1    10    99
## 2     1 a         2    11   117
## 3     1 c         3    13   160
## 4     1 a         4    13   153
## 5     1 c         5    15   200
## 6     2 a         6    15   189
## 7     2 a         7    16   207
## 8     2 c         8    18   260
## 9     2 b         9    18   243</code></pre>
</div>
<div id="data.table-4" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[, valC := valB^2 - valA^2]
DT1</code></pre>
<pre><code>##    id code valA valB valC
## 1:  1    a    1   10   99
## 2:  1    a    2   11  117
## 3:  1    c    3   13  160
## 4:  1    a    4   13  153
## 5:  1    c    5   15  200
## 6:  2    a    6   15  189
## 7:  2    a    7   16  207
## 8:  2    c    8   18  260
## 9:  2    b    9   18  243</code></pre>
</div>
</div>
<div id="question-6" class="section level3">
<h3>Question 6</h3>
<p><em>Get sum(valA) and sum(valB) grouped by id and code (i.e., for each unique combination of id,code)</em></p>
<div id="base-1" class="section level4">
<h4>base</h4>
<pre class="r"><code>aggregate(.~ id + code, DF1, sum)</code></pre>
<pre><code>##   id code valA valB valC
## 1  1    a    7   34  369
## 2  2    a   13   31  396
## 3  2    b    9   18  243
## 4  1    c    8   28  360
## 5  2    c    8   18  260</code></pre>
<pre class="r"><code>aggregate(DF1[, c(&quot;valA&quot;, &quot;valB&quot;)], list(DF1$id, DF1$code), sum)</code></pre>
<pre><code>##   Group.1 Group.2 valA valB
## 1       1       a    7   34
## 2       2       a   13   31
## 3       2       b    9   18
## 4       1       c    8   28
## 5       2       c    8   18</code></pre>
</div>
<div id="dplyr-5" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 %&gt;% group_by(id, code) %&gt;% summarise_all(sum)</code></pre>
<pre><code>## # A tibble: 5 x 5
## # Groups:   id [2]
##      id code   valA  valB  valC
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 a         7    34   369
## 2     1 c         8    28   360
## 3     2 a        13    31   396
## 4     2 b         9    18   243
## 5     2 c         8    18   260</code></pre>
</div>
<div id="data.table-5" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[, .(SumA=sum(valA), SumB = sum(valB)), by=list(id,code) ] </code></pre>
<pre><code>##    id code SumA SumB
## 1:  1    a    7   34
## 2:  1    c    8   28
## 3:  2    a   13   31
## 4:  2    c    8   18
## 5:  2    b    9   18</code></pre>
</div>
</div>
<div id="question-7" class="section level3">
<h3>Question 7</h3>
<p><em>Get sum(valA) and sum(valB) grouped by id for id &gt;= 2 &amp; code %in% c(“a”, “c”)</em></p>
<div id="base-2" class="section level4">
<h4>base</h4>
<pre class="r"><code>aggregate(.~ id , subset(DF1, id &gt;=2 &amp; code %in% c(&quot;a&quot;,&quot;c&quot;), -code), sum)</code></pre>
<pre><code>##   id valA valB valC
## 1  2   21   49  656</code></pre>
</div>
<div id="dplyr-6" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 %&gt;% 
  group_by(id) %&gt;% 
  filter(id &gt;=2, code %in% c(&quot;a&quot;, &quot;c&quot;)) %&gt;% 
  select(-code, -valC) %&gt;% 
  summarise_all(sum)</code></pre>
<pre><code>## # A tibble: 1 x 3
##      id  valA  valB
##   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     2    21    49</code></pre>
</div>
<div id="data.table-6" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[ (id&gt;=2) &amp; code %in% c(&quot;a&quot;, &quot;c&quot;) , .(SumA=sum(valA), SumB = sum(valB)), by=id ] </code></pre>
<pre><code>##    id SumA SumB
## 1:  2   21   49</code></pre>
</div>
</div>
<div id="question-8" class="section level3">
<h3>Question 8</h3>
<p><em>Replace valA with max(valA)-min(valA) grouped by code</em></p>
<div id="base-3" class="section level4">
<h4>base</h4>
<pre class="r"><code>DF1 &lt;- transform(DF1, valA = rep(tapply(valA, code, function(x) diff(range(x)))[code]))
DF1</code></pre>
<pre><code>##   id code valA valB valC
## 1  1    a    6   10   99
## 2  1    a    6   11  117
## 3  1    c    5   13  160
## 4  1    a    6   13  153
## 5  1    c    5   15  200
## 6  2    a    6   15  189
## 7  2    a    6   16  207
## 8  2    c    5   18  260
## 9  2    b    0   18  243</code></pre>
</div>
<div id="dplyr-7" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 &lt;- TB1 %&gt;% group_by(code) %&gt;% mutate(valA= max(valA)-min(valA))
TB1</code></pre>
<pre><code>## # A tibble: 9 x 5
## # Groups:   code [3]
##      id code   valA  valB  valC
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 a         6    10    99
## 2     1 a         6    11   117
## 3     1 c         5    13   160
## 4     1 a         6    13   153
## 5     1 c         5    15   200
## 6     2 a         6    15   189
## 7     2 a         6    16   207
## 8     2 c         5    18   260
## 9     2 b         0    18   243</code></pre>
</div>
<div id="data.table-7" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[, &quot;valA&quot; := max(valA)-min(valA), by=code] 
DT1</code></pre>
<pre><code>##    id code valA valB valC
## 1:  1    a    6   10   99
## 2:  1    a    6   11  117
## 3:  1    c    5   13  160
## 4:  1    a    6   13  153
## 5:  1    c    5   15  200
## 6:  2    a    6   15  189
## 7:  2    a    6   16  207
## 8:  2    c    5   18  260
## 9:  2    b    0   18  243</code></pre>
</div>
</div>
<div id="question-9" class="section level3">
<h3>Question 9</h3>
<p><em>Create a new col named valD with max(valB)-min(valA) grouped by code</em></p>
<div id="base-4" class="section level4">
<h4>base</h4>
<pre class="r"><code>DF1 &lt;- transform(DF1, valD = by(DF1, code, function(x) max(x$valB) - min(x$valA))[code])
DF1</code></pre>
<pre><code>##   id code valA valB valC valD
## 1  1    a    6   10   99   10
## 2  1    a    6   11  117   10
## 3  1    c    5   13  160   13
## 4  1    a    6   13  153   10
## 5  1    c    5   15  200   13
## 6  2    a    6   15  189   10
## 7  2    a    6   16  207   10
## 8  2    c    5   18  260   13
## 9  2    b    0   18  243   18</code></pre>
</div>
<div id="dplyr-8" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 &lt;- TB1 %&gt;% group_by(code) %&gt;% mutate(valD= max(valB)-min(valA))
TB1</code></pre>
<pre><code>## # A tibble: 9 x 6
## # Groups:   code [3]
##      id code   valA  valB  valC  valD
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 a         6    10    99    10
## 2     1 a         6    11   117    10
## 3     1 c         5    13   160    13
## 4     1 a         6    13   153    10
## 5     1 c         5    15   200    13
## 6     2 a         6    15   189    10
## 7     2 a         6    16   207    10
## 8     2 c         5    18   260    13
## 9     2 b         0    18   243    18</code></pre>
</div>
<div id="data.table-8" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT1[, &quot;valD&quot; := max(valB)-min(valA), by=code] 
DT1</code></pre>
<pre><code>##    id code valA valB valC valD
## 1:  1    a    6   10   99   10
## 2:  1    a    6   11  117   10
## 3:  1    c    5   13  160   13
## 4:  1    a    6   13  153   10
## 5:  1    c    5   15  200   13
## 6:  2    a    6   15  189   10
## 7:  2    a    6   16  207   10
## 8:  2    c    5   18  260   13
## 9:  2    b    0   18  243   18</code></pre>
</div>
</div>
<div id="question-10" class="section level3">
<h3>Question 10</h3>
<p><em>Subset DF1 by DF2 on id,code column. That is, for each row of DF2$id, DF2$code, get valA and valB cols from DF1. Include rows that have no matches as well.</em></p>
<div id="base-5" class="section level4">
<h4>base</h4>
<pre class="r"><code>merge(DF1, DF2[, c(&quot;id&quot;, &quot;code&quot;)], by = c(&quot;id&quot;, &quot;code&quot;), all.y=TRUE)</code></pre>
<pre><code>##   id code valA valB valC valD
## 1  1    a    6   13  153   10
## 2  1    a    6   10   99   10
## 3  1    a    6   11  117   10
## 4  1    c    5   13  160   13
## 5  1    c    5   15  200   13
## 6  2    c    5   18  260   13
## 7  3    b   NA   NA   NA   NA
## 8  3    d   NA   NA   NA   NA</code></pre>
</div>
<div id="dplyr-9" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>right_join(TB1, TB2 %&gt;% select(id, code), by = c(&quot;id&quot;, &quot;code&quot;)) </code></pre>
<pre><code>## # A tibble: 8 x 6
## # Groups:   code [4]
##      id code   valA  valB  valC  valD
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 a         6    10    99    10
## 2     1 a         6    11   117    10
## 3     1 c         5    13   160    13
## 4     1 a         6    13   153    10
## 5     1 c         5    15   200    13
## 6     2 c         5    18   260    13
## 7     3 b        NA    NA    NA    NA
## 8     3 d        NA    NA    NA    NA</code></pre>
<pre class="r"><code>## inner_join to keep only rows present in tibbles, left_join to keep all rows from TB1
## anti_join to keep only rows from TB1 with no matching rows in TB2</code></pre>
</div>
<div id="data.table-9" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>merge(DT1, DT2[ , .(id, code)], all.y = TRUE)</code></pre>
<pre><code>##    id code valA valB valC valD
## 1:  1    a    6   10   99   10
## 2:  1    a    6   11  117   10
## 3:  1    a    6   13  153   10
## 4:  1    c    5   13  160   13
## 5:  1    c    5   15  200   13
## 6:  2    c    5   18  260   13
## 7:  3    b   NA   NA   NA   NA
## 8:  3    d   NA   NA   NA   NA</code></pre>
</div>
</div>
<div id="question-11" class="section level3">
<h3>Question 11</h3>
<p><em>Same as (10), but fetch just the first matching row of DF1 for each row of DF2$id, DF2$code. Exclude non-matching rows.</em></p>
<div id="base-6" class="section level4">
<h4>base</h4>
<pre class="r"><code>merge(DF1[!duplicated(DF1[, c(&quot;id&quot;, &quot;code&quot;)]), ],
      DF2[, c(&quot;id&quot;, &quot;code&quot;)], by = c(&quot;id&quot;, &quot;code&quot;))</code></pre>
<pre><code>##   id code valA valB valC valD
## 1  1    a    6   10   99   10
## 2  1    c    5   13  160   13
## 3  2    c    5   18  260   13</code></pre>
</div>
<div id="dplyr-10" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>TB1 %&gt;% group_by(id, code) %&gt;% slice(1) %&gt;% ## first entry in each (id, code) group
  inner_join(select(TB2, id, code), by = c(&quot;id&quot;, &quot;code&quot;))</code></pre>
<pre><code>## # A tibble: 3 x 6
## # Groups:   id, code [3]
##      id code   valA  valB  valC  valD
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 a         6    10    99    10
## 2     1 c         5    13   160    13
## 3     2 c         5    18   260    13</code></pre>
</div>
<div id="data.table-10" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>merge(DT1[, .SD[1], by = list(id, code)], ## first entry in each (id, code) group
      DT2[ , .(id, code)])</code></pre>
<pre><code>##    id code valA valB valC valD
## 1:  1    a    6   10   99   10
## 2:  1    c    5   13  160   13
## 3:  2    c    5   18  260   13</code></pre>
</div>
</div>
<div id="question-12" class="section level3">
<h3>Question 12</h3>
<p><em>For every row of DF2$id, DF2$code that matches with DF1’s, update valA with valA*mul.</em></p>
<div id="base-7" class="section level4">
<h4>base</h4>
<pre class="r"><code>transform(merge(DF1, DF2, by = c(&quot;id&quot;, &quot;code&quot;), all.y=TRUE), valA = valA * mul)</code></pre>
<pre><code>##   id code valA valB valC valD mul
## 1  1    a   24   13  153   10   4
## 2  1    a   24   10   99   10   4
## 3  1    a   24   11  117   10   4
## 4  1    c   15   13  160   13   3
## 5  1    c   15   15  200   13   3
## 6  2    c   10   18  260   13   2
## 7  3    b   NA   NA   NA   NA   5
## 8  3    d   NA   NA   NA   NA   1</code></pre>
</div>
<div id="dplyr-11" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>right_join(TB1, TB2, by = c(&quot;id&quot;, &quot;code&quot;)) %&gt;% mutate(valA = valA * mul)</code></pre>
<pre><code>## # A tibble: 8 x 7
## # Groups:   code [4]
##      id code   valA  valB  valC  valD   mul
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1     1 a        24    10    99    10     4
## 2     1 a        24    11   117    10     4
## 3     1 c        15    13   160    13     3
## 4     1 a        24    13   153    10     4
## 5     1 c        15    15   200    13     3
## 6     2 c        10    18   260    13     2
## 7     3 b        NA    NA    NA    NA     5
## 8     3 d        NA    NA    NA    NA     1</code></pre>
</div>
<div id="data.table-11" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>DT3 &lt;- merge(DT1, DT2, all.y = TRUE)[ , &quot;valA&quot; := valA * mul]
show(DT3) ## je ne comprends pas pourquoi il faut utiliser show pour l&#39;affichage</code></pre>
<pre><code>##    id code valA valB valC valD mul
## 1:  1    a   24   10   99   10   4
## 2:  1    a   24   11  117   10   4
## 3:  1    a   24   13  153   10   4
## 4:  1    c   15   13  160   13   3
## 5:  1    c   15   15  200   13   3
## 6:  2    c   10   18  260   13   2
## 7:  3    b   NA   NA   NA   NA   5
## 8:  3    d   NA   NA   NA   NA   1</code></pre>
</div>
</div>
<div id="question-13" class="section level3">
<h3>Question 13</h3>
<p><em>Add a new column val to DF1 with values from DF2$mul where DF2$id, DF2$code matches with DF1’s. Rows that don’t match should have NA.</em></p>
<div id="base-8" class="section level4">
<h4>base</h4>
<pre class="r"><code>transform(merge(DF1, DF2, by = c(&quot;id&quot;, &quot;code&quot;), all.x = TRUE, sort = FALSE), mul = mul)</code></pre>
<pre><code>##   id code valA valB valC valD mul
## 1  1    a    6   13  153   10   4
## 2  1    a    6   10   99   10   4
## 3  1    a    6   11  117   10   4
## 4  1    c    5   13  160   13   3
## 5  1    c    5   15  200   13   3
## 6  2    c    5   18  260   13   2
## 7  2    b    0   18  243   18  NA
## 8  2    a    6   15  189   10  NA
## 9  2    a    6   16  207   10  NA</code></pre>
</div>
<div id="dplyr-12" class="section level4">
<h4>dplyr</h4>
<pre class="r"><code>left_join(TB1, TB2, by = c(&quot;id&quot;, &quot;code&quot;))</code></pre>
<pre><code>## # A tibble: 9 x 7
## # Groups:   code [3]
##      id code   valA  valB  valC  valD   mul
##   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1     1 a         6    10    99    10     4
## 2     1 a         6    11   117    10     4
## 3     1 c         5    13   160    13     3
## 4     1 a         6    13   153    10     4
## 5     1 c         5    15   200    13     3
## 6     2 a         6    15   189    10    NA
## 7     2 a         6    16   207    10    NA
## 8     2 c         5    18   260    13     2
## 9     2 b         0    18   243    18    NA</code></pre>
</div>
<div id="data.table-12" class="section level4">
<h4>data.table</h4>
<pre class="r"><code>merge(DT1, DT2, all.x = TRUE)</code></pre>
<pre><code>##    id code valA valB valC valD mul
## 1:  1    a    6   10   99   10   4
## 2:  1    a    6   11  117   10   4
## 3:  1    a    6   13  153   10   4
## 4:  1    c    5   13  160   13   3
## 5:  1    c    5   15  200   13   3
## 6:  2    a    6   15  189   10  NA
## 7:  2    a    6   16  207   10  NA
## 8:  2    b    0   18  243   18  NA
## 9:  2    c    5   18  260   13   2</code></pre>
</div>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/tidy/">tidy</a>
  
  <a class="badge badge-light" href="/tag/data.table/">data.table</a>
  
  <a class="badge badge-light" href="/tag/dplyr/">dplyr</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=http://stateofther.github.io/post/data.table/&amp;text=Exercices%20autour%20de%20data.table" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=http://stateofther.github.io/post/data.table/&amp;t=Exercices%20autour%20de%20data.table" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Exercices%20autour%20de%20data.table&amp;body=http://stateofther.github.io/post/data.table/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=http://stateofther.github.io/post/data.table/&amp;title=Exercices%20autour%20de%20data.table" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Exercices%20autour%20de%20data.table%20http://stateofther.github.io/post/data.table/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=http://stateofther.github.io/post/data.table/&amp;title=Exercices%20autour%20de%20data.table" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="/author/"><img class="avatar mr-3 avatar-circle" src="/author/avatar_hu53047fbf4f6efa69f0f91be25bd21dde_40228_270x270_fill_q90_lanczos_center.jpg" alt=""></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="/author/"></a></h5>
      <h6 class="card-subtitle">rédacteur</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:stateofr@gmail.com" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/RUG_stateofther" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/stateofther" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>














  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/une-introduction-au-tidyverse/">Une introduction au tidyverse</a></li>
      
      <li><a href="/post/manipulating-half-big-data-in-r/">Manipulation de (quasi) big data en R</a></li>
      
      <li><a href="/post/migale/">La plateforme Migale</a></li>
      
      <li><a href="/post/tidyverse_sequel/">Tidyverse suite (et fin??) avec forcats, lubridate et stringr</a></li>
      
      <li><a href="/post/rmarkdown/">Développement autour du R-Markdown</a></li>
      
    </ul>
  </div>
  





  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script async defer src="https://maps.googleapis.com/maps/api/js?key="></script>
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
      
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.4c2bca31150ce93c5a5e43b8a50f22fd.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © 2020 State of the R
  </p>

  
  






  <p class="powered-by">
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
